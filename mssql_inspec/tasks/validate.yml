---
# Validation tasks for MSSQL InSpec role

- name: Handle sensitive connection parameters
  block:
    - name: Set database connection parameters
      set_fact:
        mssql_connection:
          server: "{{ mssql_server }}"
          port: "{{ mssql_port }}"
          database: "{{ mssql_database }}"
          username: "{{ mssql_username }}"
          password: "{{ mssql_password }}"
          version: "{{ mssql_version }}"

    - name: Validate required parameters
      assert:
        that:
          - mssql_server is defined
          - mssql_port is defined
          - mssql_database is defined
          - mssql_username is defined
          - mssql_password is defined
          - mssql_version is defined
        fail_msg: "Required MSSQL connection parameters are missing"
  no_log: true

