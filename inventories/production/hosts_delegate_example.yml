---
# Production Inventory - DELEGATE MODE Example
# InSpec runs on a bastion/jump server that connects to databases

all:
  hosts:
    # Delegate/bastion host where InSpec will execute
    inspec-runner:
      ansible_host: jumphost.example.com
      ansible_connection: ssh
      ansible_user: ansible_svc
      ansible_ssh_common_args: "-o StrictHostKeyChecking=accept-new"
      # ansible_ssh_private_key_file: /path/to/key  # For key-based auth

  children:
    mssql_databases:
      hosts:
        SQLPROD01_1433:
          mssql_server: sqlprod01.example.com
          mssql_port: 1433
          mssql_version: "2019"

        SQLPROD02_1433:
          mssql_server: sqlprod02.example.com
          mssql_port: 1433
          mssql_version: "2017"

      vars:
        # DELEGATE MODE: Point to inventory hostname (not ansible_host)
        inspec_delegate_host: "inspec-runner"
        mssql_username: nist_scan_user
        # mssql_password: injected by AAP2 Custom Credential
        inspec_results_dir: /tmp/inspec_mssql_results
        inspec_debug_mode: false
        generate_summary_report: true

    oracle_databases:
      hosts:
        ORAPROD01_1521:
          oracle_server: oraprod01.example.com
          oracle_port: 1521
          oracle_service: ORCL
          oracle_version: "19"

      vars:
        inspec_delegate_host: "inspec-runner"
        oracle_username: nist_scan_user
        # oracle_password: injected by AAP2 Custom Credential

    sybase_databases:
      hosts:
        SYBPROD01_5000:
          sybase_server: sybprod01.example.com
          sybase_port: 5000
          sybase_version: "16"

      vars:
        inspec_delegate_host: "inspec-runner"
        sybase_username: nist_scan_user
        sybase_use_ssh: true
        sybase_ssh_user: sybase_admin

# KEY CONCEPTS:
# - inspec_delegate_host uses the INVENTORY hostname ("inspec-runner")
# - NOT the ansible_host value ("jumphost.example.com")
# - Ansible resolves the actual hostname via ansible_host
# - hostvars['inspec-runner'] works, hostvars['jumphost.example.com'] does NOT
