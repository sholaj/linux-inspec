---
# AAP2 Job Template Configuration: PostgreSQL Compliance Scan

job_template:
  name: "PostgreSQL Compliance Scan"
  description: "Execute InSpec CIS Benchmark compliance scans on PostgreSQL databases"
  job_type: run
  inventory: "Database Compliance Inventory"
  project: "linux-inspec"
  playbook: "test_playbooks/run_postgres_inspec.yml"
  execution_environment: "db-compliance-ee"

  credentials:
    - name: "PostgreSQL Scan Account"
      credential_type: "PostgreSQL Database Credential"
    - name: "Delegate Host SSH Key"
      credential_type: "Machine"

  extra_vars:
    base_results_dir: "/tmp/compliance_scans/postgres"
    inspec_debug_mode: false
    generate_summary_report: true
    cleanup_temp_files: true

  limit: "postgres_databases"
  verbosity: 0
  forks: 5
  timeout: 3600

  survey_enabled: true
  survey_spec:
    name: "PostgreSQL Scan Options"
    description: "Configure PostgreSQL compliance scan options"
    spec:
      - question_name: "Enable Debug Mode"
        question_description: "Show detailed scan progress and InSpec output"
        variable: "inspec_debug_mode"
        type: "multiplechoice"
        choices:
          - "true"
          - "false"
        default: "false"
        required: false
