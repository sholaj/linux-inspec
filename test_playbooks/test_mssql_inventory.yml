---
# Test inventory for MSSQL implementation validation
# Update with your actual values before running tests

all:
  # ========================================
  # OPTIONAL: Remote Delegate Host
  # Uncomment ONLY if NOT using local execution
  # ========================================
  # hosts:
  #   inspec-delegate-host:
  #     ansible_host: your-delegate-server.example.com
  #     ansible_connection: ssh
  #     ansible_user: ansible-svc
  #     ansible_port: 22
  #     # Choose ONE authentication method:
  #     # Method A: SSH Key (Recommended for production)
  #     ansible_ssh_private_key_file: /path/to/ssh/private/key
  #     # Method B: Password (Testing/Dev only)
  #     # ansible_password: "{{ vault_delegate_password }}"

  children:
    # MSSQL database servers (data sources)
    mssql_databases:
      hosts:
        # Example MSSQL server - replace with your actual server
        testmssql01_1433:
          mssql_server: your-mssql-server.example.com
          mssql_port: 1433
          mssql_version: "2019"
          database_platform: mssql

      vars:
        mssql_username: nist_scan_user
        # mssql_password: injected by AAP2 via extra vars
        # inspec_delegate_host: "inspec-delegate-host"  # Uncomment for remote delegate

  vars:
    base_results_dir: /tmp/compliance_scans
    inspec_debug_mode: false
    inspec_command_timeout: 1800

# ========================================
# CONNECTION MODES
# ========================================
#
# LOCAL EXECUTION (Default):
#   - inspec_delegate_host is "localhost" or not set
#   - InSpec runs on AAP2 execution node
#   - Execution node needs: InSpec, MSSQL tools (sqlcmd), network access to DBs
#
# REMOTE DELEGATE EXECUTION:
#   - Define delegate host in all.hosts section above
#   - Set inspec_delegate_host: "<hostname>" in group vars
#   - Ansible SSHs to delegate, runs InSpec there
#   - Delegate needs: InSpec, MSSQL tools (sqlcmd), network access to DBs
#
# ========================================
# AAP2 CREDENTIALS
# ========================================
#
# Create custom credential type in AAP2:
#   - mssql_password: Single password for all MSSQL DBs (RBAC)
#
# AAP2 injects this as extra var at job runtime.
#
# ========================================
# BEFORE RUNNING TESTS
# ========================================
#
# 1. Update mssql_server with actual MSSQL server hostname
# 2. Ensure execution host (local or delegate) has:
#    - InSpec installed at /usr/bin/inspec
#    - MSSQL tools installed (sqlcmd)
#    - Network access to MSSQL server
# 3. For remote delegate: uncomment all.hosts section and set inspec_delegate_host
