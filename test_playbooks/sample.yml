---
# Sample Inventory - Database Compliance Scanning
# Demonstrates both local and remote delegate execution modes

all:
  # ========================================
  # OPTIONAL: Remote Delegate Host
  # Uncomment ONLY if NOT using local execution
  # ========================================
  # hosts:
  #   inspec-runner:
  #     ansible_host: delegate.example.com
  #     ansible_connection: ssh
  #     ansible_user: ansible_svc
  #     # Authentication - choose ONE:
  #     # Option A: SSH Key (recommended for production)
  #     # ansible_ssh_private_key_file: /path/to/key
  #     # Option B: Password (AAP2 machine credential injects this automatically)
  #     # ansible_password: "{{ vault_delegate_password }}"  # For local testing only

  children:
    # ========================================
    # MSSQL Databases
    # ========================================
    mssql_databases:
      hosts:
        mssql_server_01_1433:
          mssql_server: sqlserver01.example.com
          mssql_port: 1433
          mssql_version: "2019"
          database_platform: mssql

        mssql_server_02_1433:
          mssql_server: sqlserver02.example.com
          mssql_port: 1433
          mssql_version: "2017"
          database_platform: mssql

      vars:
        mssql_username: nist_scan_user
        # mssql_password: injected by AAP2
        # inspec_delegate_host: "inspec-runner"  # Uncomment for remote delegate

    # ========================================
    # Oracle Databases
    # ========================================
    oracle_databases:
      hosts:
        oracle_db_01_1521:
          oracle_server: oracledb01.example.com
          oracle_database: ORCL
          oracle_service: ORCL
          oracle_port: 1521
          oracle_version: "19"
          database_platform: oracle

      vars:
        oracle_username: nist_scan_user
        # oracle_password: injected by AAP2

    # ========================================
    # Sybase Databases
    # ========================================
    sybase_databases:
      hosts:
        sybase_db_01_5000:
          sybase_server: sybasedb01.example.com
          sybase_database: master
          sybase_port: 5000
          sybase_version: "16"
          database_platform: sybase

      vars:
        sybase_username: nist_scan_user
        sybase_use_ssh: true
        sybase_ssh_user: oracle
        # sybase_password: injected by AAP2
        # sybase_ssh_password: injected by AAP2

# ========================================
# CONNECTION MODES
# ========================================
#
# LOCAL EXECUTION (Default):
#   - inspec_delegate_host is "localhost" or not set
#   - InSpec runs on AAP2 execution node
#   - Execution node needs: InSpec, database client tools, network access to DBs
#
# REMOTE DELEGATE EXECUTION:
#   - Define delegate host in all.hosts section
#   - Set inspec_delegate_host: "<hostname>" in group vars
#   - Ansible SSHs to delegate, runs InSpec there
#   - Delegate needs: InSpec, database client tools, network access to DBs
#
# ========================================
# AAP2 CREDENTIALS
# ========================================
#
# 1. MACHINE CREDENTIAL (Delegate SSH - if using remote delegate):
#    - AAP2 automatically injects ansible_user and ansible_password
#    - Or use SSH key in the machine credential
#    - This handles Layer 1: Ansible → Delegate Host
#
# 2. CUSTOM CREDENTIAL TYPES (Database passwords):
#    - mssql_password: Single password for all MSSQL DBs (RBAC)
#    - oracle_password: Single password for all Oracle DBs (RBAC)
#    - sybase_password: Single password for all Sybase DBs (RBAC)
#    - sybase_ssh_password: SSH tunnel password for Sybase
#    - These are injected as extra vars at job runtime
#    - This handles Layer 2: InSpec → Database
