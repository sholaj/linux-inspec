---
# Test Inventory - Database Compliance Scanning
# For local testing and validation

all:
  # Uncomment for remote delegate execution
  # hosts:
  #   inspec-delegate-host:
  #     ansible_host: delegate.example.com
  #     ansible_connection: ssh
  #     ansible_user: ansible_svc

  children:
    mssql_databases:
      hosts:
        testserver01_1433:
          mssql_server: testserver01.example.com
          mssql_port: 1433
          mssql_version: "2019"
          database_platform: mssql
      vars:
        mssql_username: nist_scan_user
        # inspec_delegate_host: "inspec-delegate-host"  # Uncomment for remote

    oracle_databases:
      hosts:
        oracleserver01_orcl_1521:
          oracle_server: oracleserver01.example.com
          oracle_database: orcl
          oracle_service: XE
          oracle_port: 1521
          oracle_version: "19"
          database_platform: oracle
      vars:
        oracle_username: nist_scan_user

    sybase_databases:
      hosts:
        sybaseserver01_master_5000:
          sybase_server: sybaseserver01.example.com
          sybase_database: master
          sybase_port: 5000
          sybase_version: "16"
          database_platform: sybase
      vars:
        sybase_username: nist_scan_user
        sybase_use_ssh: true
        sybase_ssh_user: oracle

  vars:
    base_results_dir: /tmp/compliance_scans
    inspec_debug_mode: false
