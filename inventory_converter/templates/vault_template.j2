---
# Ansible Vault file for database credentials
# Generated on {{ ansible_date_time.date }} {{ ansible_date_time.time }}
#
# IMPORTANT - AUTHENTICATION LAYERS:
# ===================================
# These are DATABASE credentials (Layer 2) - used by InSpec to connect to databases
# These are NOT the ansible_user credentials (Layer 1) used to SSH to the delegate host
#
# Layer 1 (Ansible → Delegate Host):
#   - Uses ansible_user (e.g., 'ansible-svc') configured in inventory
#   - This is your SSH/system account on the delegate host
#   - Configured in AAP2 as Machine Credential
#
# Layer 2 (InSpec → Database):
#   - Uses database credentials below (e.g., 'nist_user_scan', 'compliance_readonly')
#   - These credentials are for DATABASE connections only
#   - Configured in AAP2 as Vault Credential
#
# Replace DB_TEAM_TO_PROVIDE with actual database passwords
# Then encrypt with: ansible-vault encrypt {{ vault_file }} --vault-password-file .vaultpass
#
# Database credentials (Layer 2 - InSpec → Database):
{% for var_name, placeholder in vault_passwords.items() %}
{{ var_name }}: {{ placeholder }}
{% endfor %}
{% if platform_counts.sybase > 0 %}

# Sybase-specific: SSH from Delegate Host → Sybase Server (Layer 2.5)
# =========================================================================
# Sybase uses InSpec's SSH transport mode: delegate host SSHs to Sybase server
# This is DIFFERENT from ansible_user (which SSHs from AAP2 to delegate host)
#
# Three layers for Sybase:
#   Layer 1: Ansible → Delegate Host (ansible_user from inventory)
#   Layer 2.5: Delegate Host → Sybase Server (sybase_ssh_user below)
#   Layer 3: InSpec → Sybase Database (sybase_username in database credentials above)
#
vault_sybase_ssh_password: DB_TEAM_TO_PROVIDE
vault_sybase_ssh_private_key: |
  -----BEGIN OPENSSH PRIVATE KEY-----
  # SSH private key content goes here
  # This is for delegate host to SSH to Sybase server (InSpec SSH transport)
  # DB team should replace with actual SSH private key
  -----END OPENSSH PRIVATE KEY-----
{% endif %}