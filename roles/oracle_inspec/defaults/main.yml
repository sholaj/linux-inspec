---
# Oracle InSpec Role Default Variables

# Oracle connection defaults
oracle_username: "nist_scan_user"
oracle_port: 1521
oracle_version: "19c"
oracle_password: ""  # AAP2 injects via extra vars (single credential for all DBs with RBAC)

# Default paths and directories
base_results_dir: "/tmp/compliance_scans"
oracle_controls_base_dir: "{{ role_path }}/files"

# InSpec execution settings
inspec_command_timeout: 1800  # 30 minutes
inspec_debug_mode: false
generate_summary_report: true
inspec_delegate_host: "localhost"

# Oracle-specific settings
oracle_use_tns: false
oracle_tns_admin: ""
oracle_service_type: "service_name"  # or "sid"

# Oracle client environment paths (override these per environment)
# Defaults match the existing production delegate host configuration
ORACLE_HOME: "/tools/ver/oracle-client-21.3.0.0-32"
oracle_extra_path: "/opt/mssql-tools/bin:/tools/ver/sybase/OCS-16_0/bin"
NLS_LANG: "AMERICAN_AMERICA.AL32UTF8"

# Error handling
create_error_reports: true
continue_on_errors: true

# Pre-flight Check Configuration
# ==============================
# Pre-flight checks validate database connectivity before running InSpec scans.
# This prevents wasted time on unreachable databases and provides clear skip reports.
preflight_enabled: true              # Enable/disable pre-flight checks
preflight_port_timeout: 5            # TCP port check timeout (seconds)
preflight_auth_timeout: 10           # Database auth check timeout (seconds)
preflight_continue_on_failure: true  # Continue to next DB if preflight fails (vs fail role)

# ======================
# Batch Processing
# ======================
batch_size: 0                     # 0 = no batching (use AAP2 slicing instead)
batch_delay: 0                    # Seconds between batches (0 for parallel)
scan_timeout: 600                 # Per-host timeout (seconds)
scan_throttle: 10                 # Max concurrent scans on delegate host

# Splunk integration
send_to_splunk: false
splunk_hec_url: ""
splunk_hec_token: ""
splunk_index: "compliance_scans"
