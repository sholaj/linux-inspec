---
# MSSQL InSpec Role - Default Variables
# ======================================

# MSSQL Connection Parameters (Required)
mssql_server: ""
mssql_port: 1433
mssql_database: "master"
mssql_username: ""
mssql_password: ""
mssql_version: "2019"
mssql_service: ""  # Named instance (optional)

# Execution Mode
# - "localhost" or empty: Run InSpec on Ansible control node
# - "<hostname>": Run InSpec on remote delegate host via SSH
inspec_delegate_host: "localhost"

# ======================
# Connection Mode
# ======================
# When true, use WinRM transport with Windows/AD authentication
# When false, use direct TDS connection via sqlcmd (SQL authentication)
use_winrm: false

# ======================
# WinRM Configuration (Windows/AD Authentication)
# ======================
# Only used when use_winrm: true
# WinRM connects directly to mssql_server using AD credentials
# This allows scanning multiple SQL Servers with a single AD account
winrm_port: 5985                  # WinRM HTTP port (or 5986 for HTTPS)
winrm_username: ""                # AD username (DOMAIN\user or user@domain)
winrm_password: ""                # AD password
winrm_ssl: false                  # Use HTTPS (5986)
winrm_ssl_verify: true            # Verify SSL certificate
winrm_timeout: 60                 # Connection timeout (seconds)

# ======================
# Batch Processing
# ======================
batch_size: 0                     # 0 = no batching
batch_delay: 5                    # Seconds between batches
scan_timeout: 300                 # Per-host timeout (seconds)

# ======================
# Error Handling
# ======================
continue_on_winrm_failure: true   # Continue if WinRM connection fails
max_retry_attempts: 2             # Retry failed WinRM connections
retry_delay: 10                   # Seconds between retries

# Results Configuration
inspec_results_dir: "/tmp/inspec_mssql_results"
generate_summary_report: true
cleanup_temp_files: true

# Debug Mode - shows additional output
inspec_debug_mode: false

# Pre-flight Check Configuration
# ==============================
# Enable/disable pre-flight connectivity checks before InSpec scan
preflight_enabled: true

# Timeout for TCP port connectivity check (seconds)
preflight_port_timeout: 5

# Timeout for authentication/query test (seconds)
preflight_auth_timeout: 10

# Continue processing other databases if this one fails preflight
# When true: skips this database and continues with others
# When false: fails the entire playbook on first unreachable database
preflight_continue_on_failure: true

# Splunk Integration (optional)
send_to_splunk: false
splunk_hec_url: ""
splunk_hec_token: ""
splunk_index: "compliance_scans"

# Supported MSSQL versions (for validation)
supported_mssql_versions:
  - "2016"
  - "2017"
  - "2018"
  - "2019"
