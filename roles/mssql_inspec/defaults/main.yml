---
# MSSQL InSpec Role - Default Variables
# ======================================

# MSSQL Connection Parameters (Required)
mssql_server: ""
mssql_port: 1433
mssql_database: "master"
mssql_username: ""
mssql_password: ""
mssql_version: "2019"
mssql_service: ""  # Named instance (optional)

# Execution Mode
# - "localhost" or empty: Run InSpec on Ansible control node
# - "<hostname>": Run InSpec on remote delegate host via SSH
inspec_delegate_host: "localhost"

# Results Configuration
inspec_results_dir: "/tmp/inspec_mssql_results"
generate_summary_report: true
cleanup_temp_files: true

# Debug Mode - shows additional output
inspec_debug_mode: false

# Pre-flight Check Configuration
# ==============================
# Enable/disable pre-flight connectivity checks before InSpec scan
preflight_enabled: true

# Timeout for TCP port connectivity check (seconds)
preflight_port_timeout: 5

# Timeout for authentication/query test (seconds)
preflight_auth_timeout: 10

# Continue processing other databases if this one fails preflight
# When true: skips this database and continues with others
# When false: fails the entire playbook on first unreachable database
preflight_continue_on_failure: true

# Splunk Integration (optional)
send_to_splunk: false
splunk_hec_url: ""
splunk_hec_token: ""
splunk_index: "compliance_scans"

# Supported MSSQL versions (for validation)
supported_mssql_versions:
  - "2016"
  - "2017"
  - "2018"
  - "2019"
