---
# PostgreSQL InSpec Role - Default Variables
# ==========================================

# PostgreSQL Connection Parameters (Required)
postgres_server: ""
postgres_port: 5432
postgres_database: "postgres"
postgres_username: ""
postgres_password: ""
postgres_version: "15"

# Execution Mode
# - "localhost" or empty: Run InSpec on Ansible control node
# - "<hostname>": Run InSpec on remote delegate host via SSH
inspec_delegate_host: "localhost"

# Results Configuration
inspec_results_dir: "/tmp/inspec_postgres_results"
generate_summary_report: true
cleanup_temp_files: true

# Debug Mode - shows additional output
inspec_debug_mode: false

# Pre-flight Check Configuration
# ==============================
# Pre-flight checks validate database connectivity before running InSpec scans.
# This prevents wasted time on unreachable databases and provides clear skip reports.
preflight_enabled: true              # Enable/disable pre-flight checks
preflight_port_timeout: 5            # TCP port check timeout (seconds)
preflight_auth_timeout: 10           # Database auth check timeout (seconds)
preflight_continue_on_failure: true  # Continue to next DB if preflight fails (vs fail role)

# Splunk Integration (optional)
send_to_splunk: false
splunk_hec_url: ""
splunk_hec_token: ""
splunk_index: "compliance_scans"

# Supported PostgreSQL versions (for validation)
supported_postgres_versions:
  - "12"
  - "13"
  - "14"
  - "15"
  - "16"
  - "17"
