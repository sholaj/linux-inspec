---
# Sybase InSpec Role Default Variables

# Sybase connection defaults
sybase_username: "nist_scan_user"
sybase_port: 5000
sybase_version: "16"
sybase_password: ""  # AAP2 injects via extra vars (single credential for all DBs with RBAC)
sybase_ssh_password: ""  # AAP2 injects via extra vars (for SSH tunnel to Sybase servers)

# SSH connection settings (unique to Sybase from original script)
sybase_use_ssh: true
sybase_ssh_user: "oracle"
sybase_ssh_port: 22
sybase_ssh_key_path: "/tmp/sybase_ssh_key"

# Default paths and directories
base_results_dir: "/tmp/compliance_scans"
sybase_controls_base_dir: "{{ role_path }}/files"

# InSpec execution settings
inspec_command_timeout: 1800  # 30 minutes
inspec_debug_mode: false
generate_summary_report: true
inspec_delegate_host: "localhost"

# Sybase-specific settings
sybase_service_name: "SAP_ASE"
sybase_charset: "iso_1"

# Sybase client paths (for isql/sybase_session)
# Set these if isql is not in PATH or SYBASE env is non-standard
sybase_isql_bin: ""  # Leave empty to auto-detect, or set full path e.g. "/tools/ver/sybase/OCS-16_0/bin/isql"
sybase_home: ""      # Leave empty to use SYBASE env var, or set e.g. "/tools/ver/sybase"

# Error handling
create_error_reports: true
continue_on_errors: true

# Pre-flight Check Configuration
# ==============================
# Pre-flight checks validate database connectivity before running InSpec scans.
# This prevents wasted time on unreachable databases and provides clear skip reports.
preflight_enabled: true              # Enable/disable pre-flight checks
preflight_port_timeout: 5            # TCP port check timeout (seconds)
preflight_auth_timeout: 10           # Database auth check timeout (seconds)
preflight_continue_on_failure: true  # Continue to next DB if preflight fails (vs fail role)

# ======================
# Batch Processing
# ======================
batch_size: 0                     # 0 = no batching (use AAP2 slicing instead)
batch_delay: 0                    # Seconds between batches (0 for parallel)
scan_timeout: 600                 # Per-host timeout (seconds)
# Concurrency is controlled at playbook level via 'serial' setting
scan_throttle: 8                  # Reference value (lower due to SSH overhead)

# Splunk integration
send_to_splunk: false
splunk_hec_url: ""
splunk_hec_token: ""
splunk_index: "compliance_scans"
